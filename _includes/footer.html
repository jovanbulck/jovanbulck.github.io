{% include base_path %}

{% if site.author.github or site.author.bitbucket or site.atom_feed.hide != true %}
<div class="page__footer-follow">
  <ul class="social-icons">
    {% if site.data.ui-text[site.locale].follow_label %}
      <li><strong>{{ site.data.ui-text[site.locale].follow_label }}</strong></li>
    {% endif %}
    {% if site.author.github %}
      <li><a href="http://github.com/{{ site.author.github }}"><i class="fab fa-github" aria-hidden="true"></i> GitHub</a></li>
    {% endif %}
    {% if site.author.bitbucket %}
      <li><a href="http://bitbucket.org/{{ site.author.bitbucket }}"><i class="fab fa-bitbucket" aria-hidden="true"></i> Bitbucket</a></li>
    {% endif %}
    {% if site.atom_feed.hide != true %}
    <li><a href="{% if site.atom_feed.path %}{{ site.atom_feed.path }}{% else %}{{ base_path }}/feed.xml{% endif %}"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> {{ site.data.ui-text[site.locale].feed_label | default: "Feed" }}</a></li>
    {% endif %}
  </ul>
</div>
{% endif %}

<div class="page__footer-copyright">
  &copy; {{ site.time | date: '%Y' }} {{ site.name | default: site.title }}, {{ site.data.ui-text[site.locale].powered_by | default: "Powered by" }} <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.<br />
  Site last updated {{ "now" | date: '%Y-%m-%d' }}
</div>

<script>
function toggleCollapse(id) {
  var div = id ? document.querySelector("." + id) : null;
  var cur = div ? div.style.display : null;

  Array.from(document.getElementsByClassName('collapsible-panel')).forEach(panel => {
    Array.from(panel.children).forEach(content => {
    content.style.display = "none"
    });
  });

  if (cur && cur !== "block") {
    div.style.display = "block";
  }
}
</script>

<script>
function copyToClipboard(button) {
    const codeBlock = button.nextElementSibling;
    const code = codeBlock.innerText;
    const tooltip = button.querySelector('.tooltip');

    navigator.clipboard.writeText(code).then(() => {
        tooltip.style.visibility = 'visible';
        tooltip.style.opacity = '1';

        setTimeout(() => {
            tooltip.style.visibility = 'hidden';
            tooltip.style.opacity = '0';
        }, 2000);
    }).catch(err => {
        console.error('Failed to copy: ', err);
    });
}
</script>

<script>
    var paper_topics = [
        {% for p in site.data.papers.pubs %}
            {
                id: "{{ p.id }}",
                topics: "{{ p.topic }}",
                year: {{ p.year }}
            }{% if forloop.last == false %},{% endif %}
        {% endfor %}
    ];

    function filterPapersByTopic(topic) {
        var years_seen = {};

        paper_topics.forEach(function(item) {
            var row = document.getElementById(item.id);
            if (row) {
                if (item.topics.includes(topic)) {
                    row.style.display = "";
                    var yearCol = row.querySelector('.year');
                    if (!years_seen[item.year]) {
                      yearCol.innerText = item.year;
                      years_seen[item.year] = true;
                    }
                    else {
                      yearCol.innerText = "";
                    }
                } else {
                    row.style.display = "none";
                }
            }
        });
        document.getElementById("filter-dropdown").value = topic;
        toggleCollapse();
    }
</script>